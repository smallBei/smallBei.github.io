<p><strong>中等</strong></p>
<p>给你一个有序数组 <code>nums</code> ，请你 <strong><a href="http://baike.baidu.com/item/%E5%8E%9F%E5%9C%B0%E7%AE%97%E6%B3%95">原地</a></strong> 删除重复出现的元素，使得出现次数超过两次的元素<strong>只出现两次</strong> ，返回删除后数组的新长度。</p>
<p>不要使用额外的数组空间，你必须在 <strong><a href="https://baike.baidu.com/item/%E5%8E%9F%E5%9C%B0%E7%AE%97%E6%B3%95">原地</a> 修改输入数组</strong> 并在使用 O(1) 额外空间的条件下完成。</p>
<p><strong>说明：</strong></p>
<p>为什么返回数值是整数，但输出的答案是数组呢？</p>
<p>请注意，输入数组是以**「引用」**方式传递的，这意味着在函数里修改输入数组对于调用者是可见的。</p>
<p>你可以想象内部操作如下:</p>
<pre><code><span class="hljs-comment">//nums 是以“引用”方式传递的。也就是说，不对实参做任何拷贝</span>
<span class="hljs-keyword">int</span> <span class="hljs-built_in">len</span> = removeDuplicates(nums);

<span class="hljs-comment">// 在函数里修改输入数组对于调用者是可见的。</span>
<span class="hljs-comment">// 根据你的函数返回的长度, 它会打印出数组中 该长度范围内 的所有元素。</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">len</span>; i++) {
    <span class="hljs-built_in">print</span>(nums[i]);
}
</code></pre><p><strong>示例 1：</strong></p>
<pre><code>输入：nums = [<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]
输出：<span class="hljs-number">5</span>, nums = [<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]
解释：函数应返回新长度 length =<span class="hljs-number">5</span>, 并且原数组的前五个元素被修改为<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>,<span class="hljs-number">3</span>。 不需要考虑数组中超出新长度后面的元素。
</code></pre><p><strong>示例 2：</strong></p>
<pre><code>输入：nums = [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">3</span>]
输出：<span class="hljs-number">7</span>, nums = [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">3</span>]
解释：函数应返回新长度 length =<span class="hljs-number">7</span>, 并且原数组的前五个元素被修改为<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">3</span> 。 不需要考虑数组中超出新长度后面的元素。
</code></pre><p><strong>提示：</strong></p>
<ul>
<li><code>1 &lt;= nums.length &lt;= 3 * 104</code></li>
<li><code>104 &lt;= nums[i] &lt;= 104</code></li>
<li><code>nums</code> 已按升序排列</li>
</ul>
<hr>
<pre><code class="lang-swift">    func removeDuplicates(_ nums: inout [Int]) -&gt; Int {
        <span class="hljs-comment">// 数组长度小于等于2时，不需要删除重复项，直接返回数组长度</span>
        <span class="hljs-keyword">if</span> nums<span class="hljs-selector-class">.count</span> &lt;= <span class="hljs-number">2</span> {
            return nums<span class="hljs-selector-class">.count</span>
        }

        <span class="hljs-comment">// 定义变量 i 表示有效元素的下标，初始值为 1</span>
        <span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">i</span> = <span class="hljs-number">1</span>
        <span class="hljs-comment">// 定义变量 count 表示当前数字出现的次数，初始值为 1</span>
        <span class="hljs-selector-tag">var</span> count = <span class="hljs-number">1</span>

        <span class="hljs-comment">// 遍历数组，从第二个元素开始，因为第一个元素必然是有效元素</span>
        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>..&lt;nums<span class="hljs-selector-class">.count</span> {
            <span class="hljs-comment">// 如果当前元素和前一个元素相同</span>
            <span class="hljs-keyword">if</span> nums[j] == nums[j - <span class="hljs-number">1</span>] {
                <span class="hljs-comment">// 如果当前数字出现的次数小于等于2，将其标记为有效元素，并将有效元素的下标 i 加 1</span>
                <span class="hljs-keyword">if</span> count &lt; <span class="hljs-number">2</span> {
                    nums[i] = nums[j]
                    <span class="hljs-selector-tag">i</span> += <span class="hljs-number">1</span>
                }
                <span class="hljs-comment">// 将当前数字出现的次数加 1</span>
                count += <span class="hljs-number">1</span>
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// 如果当前元素和前一个元素不同，将其标记为有效元素，并将有效元素的下标 i 加 1</span>
                nums[i] = nums[j]
                <span class="hljs-selector-tag">i</span> += <span class="hljs-number">1</span>
                <span class="hljs-comment">// 将当前数字出现的次数重置为 1</span>
                count = <span class="hljs-number">1</span>
            }
        }

        <span class="hljs-comment">// 返回有效元素的个数</span>
        return <span class="hljs-selector-tag">i</span>
    }
</code></pre>
<p>上述代码的解题思路如下：</p>
<p>题目要求删除有序数组中的重复项，但是每个数字最多出现两次。因此，我们可以定义一个变量 <code>count</code> 来记录当前数字出现的次数，如果当前数字出现的次数小于等于2，则将其标记为有效元素。如果当前数字出现的次数大于2，则将其标记为无效元素，继续遍历数组。最终，将有效元素放在数组的前面，并返回有效元素的个数。</p>
<p>优化一下代码：</p>
<pre><code class="lang-swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">removeDuplicates</span><span class="hljs-params">(<span class="hljs-number">_</span> nums: <span class="hljs-keyword">inout</span> [Int])</span></span> -&gt; <span class="hljs-type">Int</span> {
    <span class="hljs-keyword">let</span> length = nums.<span class="hljs-built_in">count</span>
    <span class="hljs-keyword">if</span> length &lt; <span class="hljs-number">3</span> { <span class="hljs-keyword">return</span> length }
    <span class="hljs-keyword">var</span> slow = <span class="hljs-number">2</span>, fast = <span class="hljs-number">2</span> <span class="hljs-comment">// 定义 0..&lt;slow 为满足题意的区间</span>
    <span class="hljs-keyword">while</span> fast &lt; length {
        <span class="hljs-comment">// 重点是理解这里的 slow 的含义</span>
        <span class="hljs-comment">// slow 代表一个坑位，我们要确保 nums[slow-2] != nums[slow]</span>
        <span class="hljs-comment">// 那我们就需要找到每一个与 nums[slow-2] 不同的值填入 nums[slow]</span>
        <span class="hljs-keyword">if</span> nums[fast] != nums[slow - <span class="hljs-number">2</span>] {
            nums[slow] = nums[fast]
            slow += <span class="hljs-number">1</span>
        }
        fast += <span class="hljs-number">1</span>
    }
    <span class="hljs-keyword">return</span> slow
}
</code></pre>
